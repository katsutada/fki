<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>Search Central</title>
	
<style>
body { font-family: Arial; margin: 30px; }
input { padding: 5px; }
#error { color: red; margin-top: 10px; }
button { padding: 5px 15px; cursor: pointer; }

		.btn1color {		
		cursor: pointer;
		padding: 1px 15px;
		border: 1px solid #bfbfbc;
		border-style:solid;
		color: #696964;
		background-color: #FFFFFF;
		text-align: center;
		transition: background-color 0.3s ease;
		}
		.btn1color:hover {
		background-color: #AFEEEE;
		}
		
</style>

</head>
<body>

    <input type="password" id="passwordInput" style="width:10%; height:5px; padding:6px 10px;">
    <button onclick="login()" class="btn1color">Go</button>
	<p id="message" style="color:#AAAAAA; font-size: 16px;"></p>


    <script>
        const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwWav08RjBMQafbN5sphmYuAcr4SwU9yc9SHUwBdfPyUXnhGDWZlh7qSJCHuOiqz5Px/exec';

        async function login() {
            const password = document.getElementById('passwordInput').value;
            const messageElement = document.getElementById('message');

            if (!password) {
                messageElement.textContent = '↑↑↑';
                return;
            }

            const formData = new FormData();
            formData.append('password', password); 

            messageElement.textContent = 'Loading...';

            try {
                const response = await fetch(GAS_WEB_APP_URL, {
                    method: 'POST',
                    body: formData 
                });

                const result = await response.json();

                if (result.success) {
                    messageElement.textContent = 'Go !';
					sessionStorage.setItem("isLogin", "1");
					sessionStorage.setItem("lastActive", Date.now());
                    window.location.href = result.redirect; 
                } else {

                    messageElement.textContent = result.message || 'Retry';
                }

            } catch (error) {
                console.error('Fetch 錯誤:', error);
                messageElement.textContent = 'Network error';
            }
        }


	document.body.addEventListener("click", () => {
    sessionStorage.setItem("lastActive", Date.now());
	});
    </script>

</body>
</html>